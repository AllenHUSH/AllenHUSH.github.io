<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[兑酒精]开发笔记 | Allen&#39;s Blog</title>
    <meta name="description" content="">
    <link rel="icon" href="/favicon.ico">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#ffffff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="white">
  <link rel="apple-touch-icon" href="/icons/icon-144x144.png">
  <link rel="mask-icon" href="/icons/icon.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.cb01ff88.css" as="style"><link rel="preload" href="/assets/js/app.ec38c9f2.js" as="script"><link rel="preload" href="/assets/js/2.d0fa586e.js" as="script"><link rel="preload" href="/assets/js/15.8947625c.js" as="script"><link rel="prefetch" href="/assets/js/10.70461273.js"><link rel="prefetch" href="/assets/js/11.70399b85.js"><link rel="prefetch" href="/assets/js/12.fcb69d52.js"><link rel="prefetch" href="/assets/js/13.f6f39a46.js"><link rel="prefetch" href="/assets/js/14.ab401308.js"><link rel="prefetch" href="/assets/js/16.279e3263.js"><link rel="prefetch" href="/assets/js/17.969b11f9.js"><link rel="prefetch" href="/assets/js/18.14aac10e.js"><link rel="prefetch" href="/assets/js/19.3aa98401.js"><link rel="prefetch" href="/assets/js/20.4b98d070.js"><link rel="prefetch" href="/assets/js/21.a42ae304.js"><link rel="prefetch" href="/assets/js/22.c515337b.js"><link rel="prefetch" href="/assets/js/23.4ce732a9.js"><link rel="prefetch" href="/assets/js/24.30057529.js"><link rel="prefetch" href="/assets/js/25.6a0b3eca.js"><link rel="prefetch" href="/assets/js/26.3ead4467.js"><link rel="prefetch" href="/assets/js/27.0170e270.js"><link rel="prefetch" href="/assets/js/28.63e56b9b.js"><link rel="prefetch" href="/assets/js/29.793d5db8.js"><link rel="prefetch" href="/assets/js/3.1e3dc56e.js"><link rel="prefetch" href="/assets/js/30.12e67cc8.js"><link rel="prefetch" href="/assets/js/31.eda1d3c5.js"><link rel="prefetch" href="/assets/js/32.d8dd1097.js"><link rel="prefetch" href="/assets/js/33.dcfb01ff.js"><link rel="prefetch" href="/assets/js/34.a5da1922.js"><link rel="prefetch" href="/assets/js/35.9a3bffdb.js"><link rel="prefetch" href="/assets/js/36.01dd0de0.js"><link rel="prefetch" href="/assets/js/37.643033a6.js"><link rel="prefetch" href="/assets/js/38.5401f7da.js"><link rel="prefetch" href="/assets/js/39.c406d462.js"><link rel="prefetch" href="/assets/js/4.ffa5dc86.js"><link rel="prefetch" href="/assets/js/40.28abc696.js"><link rel="prefetch" href="/assets/js/41.ffa9ef8c.js"><link rel="prefetch" href="/assets/js/42.96495a3d.js"><link rel="prefetch" href="/assets/js/43.7d8756cb.js"><link rel="prefetch" href="/assets/js/44.6671a9a0.js"><link rel="prefetch" href="/assets/js/45.8d6fee0f.js"><link rel="prefetch" href="/assets/js/46.d5772ac7.js"><link rel="prefetch" href="/assets/js/47.4f09336b.js"><link rel="prefetch" href="/assets/js/5.5fa13e52.js"><link rel="prefetch" href="/assets/js/6.b7ad500e.js"><link rel="prefetch" href="/assets/js/7.967185c5.js"><link rel="prefetch" href="/assets/js/8.de1fd8b8.js"><link rel="prefetch" href="/assets/js/9.62906c02.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb01ff88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Allen's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Default/" class="nav-link router-link-active">Default</a></div><div class="nav-item"><a href="/Tips/" class="nav-link">Tips</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/前端/HTML/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/Web/前端/CSS/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/Web/前端/Js/" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Web/算法/" class="nav-link">Algorithms</a></li><li class="dropdown-item"><!----> <a href="/Web/Node/" class="nav-link">Node</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Default/" class="nav-link router-link-active">Default</a></div><div class="nav-item"><a href="/Tips/" class="nav-link">Tips</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web" class="dropdown-title"><span class="title">Web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web/前端/HTML/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/Web/前端/CSS/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/Web/前端/Js/" class="nav-link">JS</a></li><li class="dropdown-item"><!----> <a href="/Web/算法/" class="nav-link">Algorithms</a></li><li class="dropdown-item"><!----> <a href="/Web/Node/" class="nav-link">Node</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Default/我只是想要一台办公机——1500元的AMD YES！.html" class="sidebar-link">我只是想要一台办公机——1500元的AMD YES！</a></li><li><a href="/Default/[兑酒精]开发笔记.html" class="active sidebar-link">[兑酒精]开发笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#技术选型" class="sidebar-link">技术选型</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#开发总览" class="sidebar-link">开发总览</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#开发中疑难点记录" class="sidebar-link">开发中疑难点记录</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#思考" class="sidebar-link">思考</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#用户到底想计算哪个？" class="sidebar-link">用户到底想计算哪个？</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#进行分类" class="sidebar-link">进行分类</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#一个神奇的黑盒函数" class="sidebar-link">一个神奇的黑盒函数</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#逆波兰表达式" class="sidebar-link">逆波兰表达式</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#为什么没有在小程序中使用这种方案？" class="sidebar-link">为什么没有在小程序中使用这种方案？</a></li></ul></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#业务代码提要及衍生算法" class="sidebar-link">业务代码提要及衍生算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#wxml" class="sidebar-link">wxml</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#js" class="sidebar-link">js</a></li><li class="sidebar-sub-header"><a href="/Default/[兑酒精]开发笔记.html#衍生算法（输入一元一次方程的字符串，输出解）" class="sidebar-link">衍生算法（输入一元一次方程的字符串，输出解）</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="兑酒精-开发笔记"><a href="#兑酒精-开发笔记" class="header-anchor">#</a> [兑酒精]开发笔记</h1> <p><img src="https://imgformd-1258626057.cos.ap-shanghai.myqcloud.com/202007/05/gh_bf771021835b_258.jpg" alt="小程序二维码"></p> <h2 id="技术选型"><a href="#技术选型" class="header-anchor">#</a> 技术选型</h2> <ul><li>框架：无特殊需求，小程序原生框架即满足；</li> <li>UI：WeUI，官方框架，上手快例子多，且可深度定制，后文讲道；</li></ul> <h2 id="开发总览"><a href="#开发总览" class="header-anchor">#</a> 开发总览</h2> <ul><li>从新建项目到上传：1小时40分钟；
<ul><li>核心业务逻辑：40分钟；</li> <li>页面搭建：20分钟（因之前有类似项目，项目配置与页面结构有参考较快）；</li> <li>样式调优：40分钟；</li></ul></li> <li>思考：这几天每天都有思考，甚至半夜三点想到好玩的点子睡意全无；</li></ul> <h2 id="开发中疑难点记录"><a href="#开发中疑难点记录" class="header-anchor">#</a> 开发中疑难点记录</h2> <ul><li><p>定制深色模式</p> <p>WeUI本身支持深色模式，但其通过维护一个全局变量，来切换CSS预设变量来实现；这个方案不优雅——必须用户手动手动触发，不能监测系统配色倾向；实现自动触发有两种方案——</p> <ol><li>JavaScript媒体查询：不能实现，因小程序的DOM层没有window对象，无法绑定一个媒体查询监听器，弃之；</li> <li>CSS媒体查询：可行，将WeUI本身通过变量来维护的CSS预设，通过CSS媒体查询来切换；但难点在于WeUI是官方UI库，开发者不需要本地依赖即可使用（优点是不占用发行包体积），也正因如此，无法在本地修改CSS文件；解决方案去github找到了WeUI的源码，下载weui.wxss文件，本地修改、引用并覆盖（优先级高）；</li></ol></li> <li><p>toptips不显示</p> <p>在提醒用户输入有误，选用了toptips，更好看美观，但起初toptips却一直无法触发；在排除掉语法错误后，没有思路，在开发者社区中发现有用户反馈类似问题，其原因是线上UI版本与开发版本不一致导致。受此启发，应该是本地weui.wxss文件影响了线上的toptips组件，尝试删除本地weui.wxss文件中toptips相关描述，问题解决；</p></li> <li><p>公式展开</p> <p>仅对“兑酒精而言”，其计算公式是简单的——</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>A</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>=</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">A.V \times A.C = T.V \times T.C
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span></span></p> <p><em>注：我们定义A、B为现有溶液，T为目标溶液，V为体积，C为浓度。</em></p> <p>很简单，对么，但它的完全展开公式（溶液稀释公式）是这样的</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>A</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>+</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>=</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">A.V \times A.C + B.V \times B.C= T.V \times T.C
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span></span></p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>+</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>=</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">A.V + B.V = T.V
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span></p> <p>只不过在对酒精的场景中，溶液B浓度为0，我们将其忽略。</p> <p>但这也很简单，直到我引出了这样的思考——</p></li></ul> <h2 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h2> <h3 id="用户到底想计算哪个？"><a href="#用户到底想计算哪个？" class="header-anchor">#</a> 用户到底想计算哪个？</h3> <p>兑酒精实例中，用户明确计算B.V，A、T.C都是已知量；</p> <p>但如果想计算其他的呢？当然可以，我们通过分析上述公式，可知——在A.V、A.C、B.V、B.C、T.V、T.C六个物理量中，可以有1或2个未知量（当有2个物理量的时候，不能同时为浓度）。固有3*6=18种情况。</p> <p>怎么做？写18个if么，当然可以，我们寝室常开玩笑——“没有什么是if解决不了的，如果有，那就说明if还不够多。”</p> <p>所以我们应该对情况进行分类，给出一个通用解决方案。</p> <h3 id="进行分类"><a href="#进行分类" class="header-anchor">#</a> 进行分类</h3> <ul><li><p>step 0 画表格，略；</p></li> <li><p>step 1</p> <ol><li><p>只有1个V未知（3种）</p> <p>计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>+</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>=</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>V</mi></mrow><annotation encoding="application/x-tex">A.V + B.V = T.V</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span>即可</p></li> <li><p>只有1个C未知（3种）</p> <p>计算<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>A</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>+</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>=</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">A.V \times A.C + B.V \times B.C= T.V \times T.C</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>即可</p></li> <li><p>2个V未知（3种）</p> <p>用其中一个V来表示另一个，后计算</p></li> <li><p>1个V与1个C未知（3*3=9种）</p></li></ol> <p>先计算V（参考分类1）再计算C（参考分类2）</p></li> <li><p>step 2</p> <p>合并step 1种4种情况</p> <ol><li><p>先计算V后计算C（15种）</p> <p>对应1个V未知、1个C未知、1个V与1个C未知</p></li> <li><p>代数后计算（3种）</p> <p>对应2个V未知</p></li></ol> <p>分类至此，2种情况已经足够使用了，但问题又来了——</p></li></ul> <h3 id="一个神奇的黑盒函数"><a href="#一个神奇的黑盒函数" class="header-anchor">#</a> 一个神奇的黑盒函数</h3> <p>当我们有18种情况的时候，每一种情况都对应一个计算公式，比如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>=</mo><mo>(</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>T</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>−</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>V</mi><mo>×</mo><mi>B</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>)</mo><mo>÷</mo><mi>A</mi><mi mathvariant="normal">.</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">A.V = (T.V \times T.C - B.V \times B.C) \div A.C</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mbin">×</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mbin">÷</span><span class="mord mathit">A</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span></p> <p>当我们对情况进行合并后，难道我们还需要18个计算公式么？当然不，那分类还有什么意义。我们需要一个这样的黑盒——<strong>输入一个等式，该等式为一元可解方程，输出未知元与该未知元的解。</strong></p> <p>动手实现，思路如下——</p> <ol><li>分析输入，构造单项式（这很有用，我们将单项式视为一个数据结构，本质为对象，含有符号、系数、变量三个属性）；</li> <li>提取未知元到等式左侧，其他放在右侧；</li> <li>计算右侧，结果即为解；</li></ol> <p>实现上述思路的代码另附文件（仅满足一元一次加减运算，非常简陋），测试如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>测试用例<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">const</span> testString <span class="token operator">=</span> <span class="token string">'95A.V + 0 = 75.0T.V'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span>
  <span class="token constant">A</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token constant">V</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token constant">T</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>输出结果<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token punctuation">[</span>Running<span class="token punctuation">]</span> node <span class="token string">&quot;/Users/allen/Documents/Projects/wx_tools/linearEquation.js&quot;</span>
<span class="token punctuation">{</span> key<span class="token punctuation">:</span> <span class="token string">'T.V'</span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> <span class="token number">126.66666666666667</span> <span class="token punctuation">}</span>

<span class="token punctuation">[</span>Done<span class="token punctuation">]</span> exited <span class="token keyword">with</span> code<span class="token operator">=</span><span class="token number">0</span> <span class="token keyword">in</span> <span class="token number">0.067</span> seconds
</code></pre></div><p>但完成之后，我想到了一个名词——</p> <h3 id="逆波兰表达式"><a href="#逆波兰表达式" class="header-anchor">#</a> 逆波兰表达式</h3> <p>我并没有实现逆波兰表达式，因为我对其了解并不深刻，另一方面，在我去了解逆波兰后，发觉其对上述黑盒的实现过程，并无重大帮助，理由如下——</p> <ol><li>我们将<em>a+b+c-d</em>转换成逆波兰式为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>b</mi><mo>+</mo><mi>c</mi><mi>d</mi><mo>−</mo><mo>+</mo></mrow><annotation encoding="application/x-tex">ab+cd-+</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span><span class="mord mathit">b</span><span class="mbin">+</span><span class="mord mathit">c</span><span class="mord mathit">d</span><span class="mbin">−</span><span class="mord">+</span></span></span></span>，但实际中我们的变量名可能是arr[0].objBar.foo,所以我们仍需要格式化；</li> <li>在js中eval函数可以实现一个计算器；</li></ol> <p>综上，逆波兰<strong>似乎</strong>对我们的需求没有显著的帮助，所以未现实。但在重新复习逆波兰的时候，感觉太奇妙了，<strong>算法真好玩</strong>。</p> <h3 id="为什么没有在小程序中使用这种方案？"><a href="#为什么没有在小程序中使用这种方案？" class="header-anchor">#</a> 为什么没有在小程序中使用这种方案？</h3> <ol><li>小程序为防止开发者热更新绕过审核，屏蔽了eval函数；</li> <li>我实现的黑盒通过判断该字符是数字或其他来将其归类到系数或变量属性中，一旦涉及到数组结构访问下标了（下标是数字，但应该归类到变量而非系数），期末作业太多...不玩了不玩了弃坑。</li></ol> <h2 id="业务代码提要及衍生算法"><a href="#业务代码提要及衍生算法" class="header-anchor">#</a> 业务代码提要及衍生算法</h2> <h3 id="wxml"><a href="#wxml" class="header-anchor">#</a> wxml</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!--miniprogram/pages/alcohol/alcohol.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span>  <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-toptips</span> <span class="token attr-name">msg</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{error}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span> <span class="token attr-name">show</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{error}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-toptips</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- 标题 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page__hd<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>goToBack<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page__title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>兑酒精<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page__desc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击返回<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>page__bd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rules</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{rules}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">models</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{formData}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cells</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>现有酒精<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cell</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>浓度<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>digit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>existing.C<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindinput</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>changeInput<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>请输入<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{existing.C}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cell</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>体积<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>digit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>existing.V<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindinput</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>changeInput<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>请输入<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{existing.V}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cells</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cells</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>目标酒精<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cell</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>浓度<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>digit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>target.C<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindinput</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>changeInput<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>请输入<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{target.C}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cells</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cells</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>计算结果<span class="token punctuation">&quot;</span></span> <span class="token attr-name">footer</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>请在计算前统一单位；结果将保留5位小数<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cell</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>需要加水<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>digit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>等待计算<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{water.V||''}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">disabled</span> <span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mp-cell</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>最终体积<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>digit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>等待计算<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{{target.V||''}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">disabled</span> <span class="token punctuation">/&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cell</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-cells</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mp-form</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-btn-area<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>compute<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>计算<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weui-btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>warn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>reset<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>重置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="js"><a href="#js" class="header-anchor">#</a> js</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// miniprogram/pages/alcohol/alcohol.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mixins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../mixin/themeChanged'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    error<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    existing<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    target<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    water<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 重置表单</span>
  <span class="token function-variable function">reset</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      error<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      existing<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      target<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      water<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 监听键盘输入，实现双向绑定</span>
  <span class="token function-variable function">changeInput</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      key
    <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 计算</span>
  <span class="token function">compute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">canCompute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> targetV <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">V</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token string">'target.V'</span><span class="token punctuation">]</span><span class="token punctuation">:</span> targetV<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'water.V'</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>targetV <span class="token operator">-</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">V</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 计算前判空、判错并提醒</span>
  <span class="token function">canCompute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判空并返回</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">V</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">C</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> emptyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">V</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        emptyList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;现有酒精体积&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        emptyList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;现有酒精浓度&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        emptyList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;目标酒精浓度&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">:</span> emptyList<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'、'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;是必填项&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 判断现有酒精浓度</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">:</span> <span class="token string">&quot;请检查现有酒精浓度，取值(0,100]&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 判断现有酒精体积</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">V</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">:</span> <span class="token string">&quot;请检查现有酒精体积，取值(0,+∞)&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 判断目标酒精浓度</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>existing<span class="token punctuation">.</span><span class="token constant">C</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        error<span class="token punctuation">:</span> <span class="token string">&quot;请检查目标酒精浓度，取值(0,现有酒精浓度]&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="衍生算法（输入一元一次方程的字符串，输出解）"><a href="#衍生算法（输入一元一次方程的字符串，输出解）" class="header-anchor">#</a> 衍生算法（输入一元一次方程的字符串，输出解）</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 测试用例</span>
<span class="token keyword">const</span> testString <span class="token operator">=</span> <span class="token string">'95A.V + 0 = 75.0T.V'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span>
  <span class="token constant">A</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token constant">V</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token constant">T</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// ------------------------------------------------------------------</span>
<span class="token comment">// 格式化后的单项式数据类型参考</span>
<span class="token comment">// { op: '+', coefficient: '25.0', variate: 'A.V ' }</span>
<span class="token comment">// ------------------------------------------------------------------</span>

<span class="token comment">/**
 * 拆分多项式之和返回单项式数组
 * @param {String} polynomial 形如-2Aa+2B-35FG或者C+D-15E+12.23OO之类单项式之和
 * @return {Array} 由单项式组成的数组
 */</span>
<span class="token keyword">let</span> <span class="token function-variable function">returnMonomialArray</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">polynomial</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将输入的多项式字符串拆分成由单项式组成的字符串数组</span>
  <span class="token keyword">let</span> starIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> polynomial<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> char <span class="token operator">=</span> polynomial<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>char <span class="token operator">===</span> <span class="token string">'+'</span> <span class="token operator">||</span> char <span class="token operator">===</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>polynomial<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>starIndex<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      starIndex <span class="token operator">=</span> index<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> polynomial<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ans<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>polynomial<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>starIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 将字符串数组格式化为对象数组，并返回</span>
  <span class="token keyword">return</span> ans
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> isOp <span class="token operator">=</span> <span class="token regex">/\+|\-/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span>
          isCo <span class="token operator">=</span> <span class="token regex">/\d+(.\d+)?/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span>
          op <span class="token operator">=</span> isOp <span class="token operator">?</span> item<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\+|\-/g</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string">'+'</span><span class="token punctuation">,</span>
          coefficient <span class="token operator">=</span> isCo <span class="token operator">?</span> item<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\d+(.\d+)?/g</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span>
          variate <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isCo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          variate <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>coefficient<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>isOp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            variate <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            variate <span class="token operator">=</span> item<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          op<span class="token punctuation">,</span>
          coefficient<span class="token punctuation">,</span>
          variate
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 格式化等式
 * 输入必须满足以下条件
 * 1. 等式中只能有一个等号,多个等号将被忽略
 * 2. 一元一次且合并未知元
 * 3. 变量中不能含有数字
 * 4. 变量为基础数据类型
 * @param {String} equation
 * @return {Object { unknow{} , knowList[] } } 
 */</span>
<span class="token keyword">let</span> <span class="token function-variable function">format</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">equation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 去除等式中的空格</span>
  <span class="token comment">// 并拆分为等号左右两个表达式（如有多个等号，第二个等号及后将被忽略）</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>leftEquation<span class="token punctuation">,</span> rightEquation<span class="token punctuation">]</span> <span class="token operator">=</span> equation<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token comment">// 格式化两个表达式并存入数组（我们规定，下标0为左表达式，1为右表达式）</span>
  <span class="token comment">// 左右表达式将从字符串被格式化为由单项式构成的数组</span>
  <span class="token comment">// 每个单项式对象拥有op、coefficient、variate三个属性</span>
  <span class="token keyword">const</span> monomialArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">returnMonomialArray</span><span class="token punctuation">(</span>leftEquation<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">returnMonomialArray</span><span class="token punctuation">(</span>rightEquation<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 构造新的等式</span>
  <span class="token comment">// 未知变量的表达式将被放到等式左侧，为对象</span>
  <span class="token comment">// 已知可计算的单项式将被放到等式右侧，为数组</span>
  <span class="token keyword">let</span> unknow <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    knowList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> monomialArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> array <span class="token operator">=</span> monomialArray<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> idx <span class="token operator">&lt;</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span> idx<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> monomia <span class="token operator">=</span> array<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span>monomia<span class="token punctuation">.</span>variate<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          monomia<span class="token punctuation">.</span>op <span class="token operator">===</span> <span class="token string">'+'</span> <span class="token operator">?</span> monomia<span class="token punctuation">.</span>op <span class="token operator">=</span> <span class="token string">'-'</span> <span class="token punctuation">:</span> monomia<span class="token punctuation">.</span>op <span class="token operator">=</span> <span class="token string">'+'</span>
        <span class="token punctuation">}</span>
        knowList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>monomia<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          monomia<span class="token punctuation">.</span>op <span class="token operator">===</span> <span class="token string">'+'</span> <span class="token operator">?</span> monomia<span class="token punctuation">.</span>op <span class="token operator">=</span> <span class="token string">'-'</span> <span class="token punctuation">:</span> monomia<span class="token punctuation">.</span>op <span class="token operator">=</span> <span class="token string">'+'</span>
        <span class="token punctuation">}</span>
        unknow <span class="token operator">=</span> monomia
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    unknow<span class="token punctuation">,</span>
    knowList
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">/**
 * 计算
 * @param {String} equation 
 * @return {Object { key , value } }
 */</span>
<span class="token keyword">let</span> <span class="token function-variable function">compute</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">equation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取格式化后的表达式</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    unknow<span class="token punctuation">,</span>
    knowList
  <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">format</span><span class="token punctuation">(</span>equation<span class="token punctuation">)</span>
  <span class="token comment">// 计算已知表达式</span>
  <span class="token keyword">let</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  knowList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">know</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ans </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>know<span class="token punctuation">.</span>op<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">= </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>know<span class="token punctuation">.</span>coefficient<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">*</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">eval</span><span class="token punctuation">(</span>know<span class="token punctuation">.</span>variate<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 除以未知表达式的系数</span>
  ans <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ans / </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>unknow<span class="token punctuation">.</span>op<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>unknow<span class="token punctuation">.</span>coefficient<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> unknow<span class="token punctuation">.</span>variate<span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> ans
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">compute</span><span class="token punctuation">(</span>testString<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Default/我只是想要一台办公机——1500元的AMD YES！.html" class="prev">我只是想要一台办公机——1500元的AMD YES！</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ec38c9f2.js" defer></script><script src="/assets/js/2.d0fa586e.js" defer></script><script src="/assets/js/15.8947625c.js" defer></script>
  </body>
</html>
